auto lo lo:1
iface lo inet loopback

iface lo:1 inet static
  address ${BIRD_LOCAL_IP}/32

auto ${NIC_WIRED}
allow-hotplug ${NIC_WIRED}
iface ${NIC_WIRED} inet manual
    pre-up ${BASEDIR}/post-down.sh ${ALIAS_WIRED} ${NIC_WIRED}
    post-up udhcpc -i ${NIC_WIRED} --script=${BASEDIR}/udhcpc.script
    post-down ${BASEDIR}/post-down.sh ${ALIAS_WIRED} ${NIC_WIRED}

auto ${NIC_MOBILE}
allow-hotplug ${NIC_MOBILE}
iface ${NIC_MOBILE} inet manual
    pre-up if [ "`qmicli -d /dev/cdc-wdm0 --uim-get-card-status  | grep -c \"Card state: 'present'\"`" -eq 0 ]; then exit 1; fi
    pre-up ${BASEDIR}/pre-up.sh ${ALIAS_MOBILE} ${NIC_MOBILE}
    pre-up ifconfig ${NIC_MOBILE} down
    pre-up ifconfig wwp0s19u1u3i10 down # only needed if the modem presents two wwan interfaces
    pre-up for _ in $(seq 1 10); do /usr/bin/test -c /dev/cdc-wdm0 && break; /bin/sleep 1; done
    pre-up for _ in $(seq 1 10); do /usr/bin/qmicli -d /dev/cdc-wdm0 --nas-get-signal-strength && break; /bin/sleep 1; done
    pre-up echo Y > /sys/class/net/${NIC_MOBILE}/qmi/raw_ip
    pre-up /usr/bin/qmi-network /dev/cdc-wdm0 start
    pre-up udhcpc -i ${NIC_MOBILE} --script=${BASEDIR}/udhcpc.script
    pre-down ${BASEDIR}/post-down.sh ${ALIAS_MOBILE} ${NIC_MOBILE}
    post-down /usr/bin/qmi-network /dev/cdc-wdm0 stop

source /etc/network/interfaces.d/*
